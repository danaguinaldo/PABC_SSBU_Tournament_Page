!function(e,t){"function"==typeof define&&define.amd?define(t):"object"==typeof exports?module.exports=t():e.smartquotes=t()}(this,function(){function e(t){if(void 0===t){var a=function(){e.element(document.body)};if("loading"!==document.readyState)a();else if(document.addEventListener)document.addEventListener("DOMContentLoaded",a,!1);else var i=setInterval(function(){"loading"!==document.readyState&&(clearInterval(i),a())},10)}else{if("string"==typeof t)return e.string(t);if(t instanceof HTMLElement)return e.element(t)}}return e.string=function(e){return e.replace(/'''/g,"‴").replace(/(\W|^)"(\S)/g,"$1“$2").replace(/(\u201c[^"]*)"([^"]*$|[^\u201c"]*\u201c)/g,"$1”$2").replace(/([^0-9])"/g,"$1”").replace(/''/g,"″").replace(/(\W|^)'(\S)/g,"$1‘$2").replace(/([a-z])'([a-z])/gi,"$1’$2").replace(/((\u2018[^']*)|[a-z])'([^0-9]|$)/gi,"$1’$3").replace(/(\u2018)([0-9]{2}[^\u2019]*)(\u2018([^0-9]|$)|$|\u2019[a-z])/gi,"’$2$3").replace(/(\B|^)\u2018(?=([^\u2019]*\u2019\b)*([^\u2019\u2018]*\W[\u2019\u2018]\b|[^\u2019\u2018]*$))/gi,"$1’").replace(/'/g,"′")},e.element=function(t){function a(t){if(["CODE","PRE","SCRIPT","STYLE"].indexOf(t.nodeName)===-1){var o,s,n=t.childNodes,l=[],r="";for(o=0;o<n.length;o++)s=n[o],s.nodeType===i?(l.push([s,r.length]),r+=s.nodeValue):s.childNodes.length&&(r+=a(s));r=e.string(r);for(o in l){var c=l[o];c[0].nodeValue&&(c[0].nodeValue=r.substr(c[1],c[0].nodeValue.length))}return r}}var i=Element.TEXT_NODE||3;return a(t),t},e});